# 香港法律案件搜尋器與自動追蹤系統

本專案已新增香港法律案件搜尋器功能及每日自動追蹤系統。以下是系統架構及使用說明。

## 1. 系統架構

系統採用模組化設計，確保資料來源可以隨時更換而無需修改核心代碼。

### 核心組件：
- **`lib/tracking/types.ts`**: 定義了 `IDataSource` 介面及 `RawCase` 資料結構。
- **`lib/tracking/engine.ts`**: 追蹤引擎，負責調度各個資料來源並將結果存入數據庫。
- **`lib/tracking/sources/`**: 存放具體的爬蟲模組（如 `judiciary.ts`, `news.rss.ts`）。
- **`lib/services/publicCaseSearch.ts`**: 提供搜尋及查詢功能。

## 2. 數據模型

在 `prisma/schema.prisma` 中新增了 `PublicCase` 模型，用於存儲從外部抓取的案件資訊：
- `source`: 資料來源（如 JUDICIARY, NEWS, HKLII）
- `caseNumber`: 案件編號
- `title`: 案件標題
- `content`: 詳細內容
- `hearingDate`: 審訊日期
- `url`: 原始連結

## 3. 如何更換或新增資料來源

您可以輕鬆地在 `lib/tracking/sources/` 下新增一個類別並實作 `IDataSource` 介面：

```typescript
// 範例：新增一個私人機構資料來源
import { IDataSource, RawCase } from '../types';

export class PrivateAgencySource implements IDataSource {
  name = 'PrivateAgency';
  async fetchDailyCases(): Promise<RawCase[]> {
    // 在此實作抓取邏輯
    return [
      // 返回抓取到的案件列表
    ];
  }
}
```

然後在 `scripts/track-cases.ts` 中註冊該來源：

```typescript
engine.registerSource(new PrivateAgencySource());
```

## 4. 自動化設置

系統已設置每日凌晨自動運行追蹤腳本。手動運行方式：

```bash
pnpm tsx scripts/track-cases.ts
```

## 5. 搜尋功能

您可以在導覽列中找到 **"Public Search"** 進入搜尋頁面。該頁面支持：
- 關鍵字搜尋（標題、內容、案件編號）
- 查看最新抓取的案件列表
- 分門別類展示（來源、法院、日期）
